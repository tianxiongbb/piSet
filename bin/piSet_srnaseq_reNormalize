#!/bin/bash

if [ $# -lt 3 ];then
	echo0 4 "$0 in.dir/prefix out.dir factor_for_reNormalization"
	echo0 4 "old signal will be changed to old signal X factor"
	exit 1
fi

OUTDIR=`readlink -f $2`

for i in $1*.lendis $1*.summary
do
	if [ "${i%.chopped.summary}" == "$i" ];then
		FN=`basename $i`
		awk -v f=$3 'BEGIN{FS=OFS="\t"} {if(NR>1){for(i=2;i<=NF;i++){$i=$i*f}};print $0}' $i > ${OUTDIR}/${FN}
	fi
done

for i in $1*chopped.summary
do
	FN=`basename $i`
	awk -v f=$3 'BEGIN{FS=OFS="\t"} {if(NR>1){for(i=2;i<=(NF-1);i++){$i=$i*f}};print $0}' $i > ${OUTDIR}/${FN}
done

for i in $1*.cov
do
	FN=`basename $i`
	awk -v f=$3 'BEGIN{FS=OFS="\t"} {for(i=3;i<=NF;i++){$i=$i*f};print $0}' $i > ${OUTDIR}/${FN}
done

for i in $1*.pp
do
	FN=`basename $i`
	awk -v f=$3 'BEGIN{FS=OFS="\t"} {if(NR>1){for(i=2;i<=NF;i++){$i=$i*f*f}};print $0}' $i > ${OUTDIR}/${FN}
done
